---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
data <- read.csv("/home/RHHLab/Research/Colab/Turag/Python/DL Lab/Multivariate/DOA/epochs50/metrics.csv")
data
```


```{r}
library(ggplot2)
library(ggpubr)
theme_set(theme_pubr())
```


```{r}
ggplot(data, aes(x = Model, y = y))+
  geom_bar(
    aes(fill = Metrics), stat = "identity", color = "white",
    position = position_dodge(0.9)
    )+
  facet_wrap(~Model.Category) + 
  fill_palette("jco")
```


```{r}
df <- as.data.frame(HairEyeColor)
df
```


```{r}
mse <- data[,c(1,2,3)]
mae <- data[,c(1,2,4)]
r2 <- data[,c(1,2,5)]
rmse <- data[,c(1,2,6)]

data
```


```{r}
ggballoonplot(data, x = "Model", y = "Metrics", size = "y",
              fill = "y", facet.by = "Model.Category",
              ggtheme = theme_bw()) +
  scale_fill_viridis_c(option = "C")
```


```{r}
desired_order <- c("CNN", "RNN", "GRU", "LSTM", "CNN GRU", "CNN LSTM", "RNN GRU", "RNN LSTM", "CNN RNN GRU", "LSTM RNN GRU")

data$Model <- factor(data$Model, levels = desired_order)
data
```
```{r}
dso <- c("General", "MA", "HY", "DReg", "MA DReg", "MA HY")

data$Model.Category <- factor(data$Model.Category, levels = dso)
data
```


```{r}
increased_margin_theme <- theme(
  plot.margin = margin(l =1))

q <- ggballoonplot(data, x = "Model", y = "Metrics", size = "y",
              fill = "y", facet.by = "Model.Category",
              ggtheme = theme_classic()) +
  scale_fill_viridis_c(option = "C")+
  increased_margin_theme

ggsave("/home/RHHLab/Research/Colab/Turag/Figures/DOAepoch50Metricsballoon.png", plot = q,height = 6.5, width = 9, units = "in", dpi = 1000)
q
```


```{r}
desired_order <- c("CNN", "RNN", "GRU", "LSTM", "CNN GRU", "CNN LSTM", "RNN GRU", "RNN LSTM", "CNN RNN GRU", "LSTM RNN GRU")

data$Model <- factor(data$Model, levels = desired_order)
dso <- c("General", "MA", "AE", "HY", "MA AE", "MA HY")

data$Model.Category <- factor(data$Model.Category, levels = dso)
data
```


```{r}
p <- ggplot(data, aes(x = Model, y = y))+
  geom_bar(
    aes(fill = Model.Category), stat = "identity", color = "white",
    position = position_dodge(0.9)
    )+
  facet_wrap(~Metrics) + 
  fill_palette("jco")+
  theme(
  axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
  axis.text.y = element_text(hjust = 1, size = 8))+
  theme(legend.position = "right")+
  xlab("Model")+
  ylab("")

ggsave("/home/RHHLab/Research/Colab/Turag/Python/DL Lab/Multivariate/DOA/epoch50Metrics.png", plot = p,height = 6.5, width = 9, units = "in", dpi = 1000)
p
```

```{r}
library(dplyr)
library(ggplot2)
library(stringr)
```

```{r}
data <- read.csv("/home/RHHLab/Research/Colab/Turag/Python/DL Lab/Multivariate/DOA/epochs100/metricsT.csv")
data
```

```{r}
ggplot(data, aes(x = Model, y = y, fill = Metrics, colour = ModelCat)) + 
  geom_bar(stat = "identity", position = "dodge", alpha = 0.5)
```

```{r}
ggplot(data, aes(x = MSE, y = RMSE, fill = ModelCat)) +
  geom_tile(color = "black") +
  geom_text(aes(label = ModelCat), color = "white", size = 4) +
  coord_fixed()
```
```{r}
data <- read.csv("/home/RHHLab/Research/Colab/Turag/Python/DL Lab/Multivariate/DOC/epochs50/metrics.csv")
data
```

```{r}
desired_order <- c("CNN", "RNN", "GRU", "LSTM", "CNN GRU", "CNN LSTM", "RNN GRU", "RNN LSTM", "CNN RNN GRU", "LSTM RNN GRU")
data$Model <- factor(data$Model, levels = desired_order)
dso <- c("General", "MA", "HY", "DReg", "MA DReg", "MA HY")
data$Model.Category <- factor(data$Model.Category, levels = dso)

met <- c("MSE", "RMSE", "MAE", "R2")
data$Metrics <- factor(data$Metrics, levels = met)

data

```

```{r}
increased_margin_theme <- theme(
  plot.margin = margin(l =1))

q <- ggballoonplot(data, x = "Model", y = "Metrics", size = "y",
              fill = "y", facet.by = "Model.Category",
              ggtheme = theme_classic()) +
  scale_fill_viridis_c(option = "C")+
  increased_margin_theme

ggsave("/home/RHHLab/Research/Colab/Turag/Figures/DOCepoch50Metricsballoon.png", plot = q,height = 6.5, width = 9, units = "in", dpi = 1000)
q
```

```{r}
p <- ggplot(data, aes(x = Model, y = y))+
  geom_bar(
    aes(fill = Model.Category), stat = "identity", color = "white",
    position = position_dodge(0.9)
    )+
  facet_wrap(~Metrics) + 
  fill_palette("jco")+
  theme(
  axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
  axis.text.y = element_text(hjust = 1, size = 8))+
  theme(legend.position = "right")+
  xlab("S3")+
  ylab("")

ggsave("/home/RHHLab/Research/Colab/Turag/Figures/DOCepoch50MetricsBar.png", plot = p,height = 6.5, width = 9, units = "in", dpi = 1000)
p
```

```{r}

```

```{r}
data  <- read.csv("/home/RHHLab/Research/Colab/Turag/Python/DL Lab/Multivariate/DOA/data/TimeSeriesDataA.csv")
data
```

```{r}
ggplot(data, aes(Date, Values)) +                                     
  geom_line(color = "blue", size = 2.5) +  # Increase line size to 2
  facet_wrap(. ~ Param, nrow = 4)
```

```{r}
library(dplyr)
library(ggplot2)
library(lubridate)
library(timetk)
```

```{r}
data %>%
  group_by(Param) %>%
  plot_time_series(Date, Values, 
                   .facet_ncol = 2, .facet_scales = "free")
```

```{r}
g <- ggplot(data,aes(x=Date,y=Values, hue = "Param"))
g+geom_line()+geom_smooth()+
  facet_wrap(~Param, scales = "free")
```

```{r}
data <- read.csv("/home/RHHLab/Research/Colab/Turag/Python/data/Compressed.csv")
data
```

```{r}
ggplot(data, aes(x=Param, y=y, group=Location)) + 
  geom_boxplot(aes(fill=Location))+
  facet_grid(Param ~., scales = "free")
```

```{r}
library(rstatix)
library(ggpubr)
```

```{r}
stat.test <- data %>%
  group_by(Location) %>%
  t_test(y ~ Param) %>%
  adjust_pvalue(method = "bonferroni") %>%
  add_significance()
stat.test
```

```{r}
library(gapminder)
library(ggsci)
```

```{r}
desired_order <- c("DO (mg/L)", "BOD (mg/L)", "TN (mg/L)", "EC (us/cm)", "pH", "Temperature ('C)")
data$Param <- factor(data$Param, levels = desired_order)
```

```{r}
p <-  ggplot(data, aes(x= Param, y=y, fill=Location)) +
  geom_boxplot() +
  #geom_jitter(width=0.1,alpha=0.2) +
  xlab("")+ 
  ylab("")+
  facet_wrap(~Param, scales = "free")+
  scale_fill_viridis_d() +
  theme_minimal()+
  theme(strip.text = element_text(face = "bold"))

ggsave("my_plot.png", plot = p, width = 8, height = 6, dpi = 300)

```

```{r}

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
